<?xml version="1.0" encoding="UTF-8"?><html xmlns:c="http://www.concordion.org/2007/concordion" lang="en">
<head><script type="text/javascript">/* Stack Trace Toggling */

function getElementById(id) {
  var element;

  if (document.getElementById) { // standard
    return document.getElementById(id);
  } else if (document.all) { // old IE versions
    return document.all[id];
  } else if (document.layers) { // nn4
    return document.layers[id];
  }
  alert("Sorry, but your web browser is not supported by Concordion.");
}

function isVisible(element) {
  return element.style.display;
}

function makeVisible(element) {
  element.style.display = "block";
}

function makeInvisible(element) {
  element.style.display = "";
}

function toggleStackTrace(stackTraceNumber) {
  var stackTrace = getElementById("stackTrace" + stackTraceNumber);
  var stackTraceButton = getElementById("stackTraceButton" + stackTraceNumber);
  if (isVisible(stackTrace)) {
    makeInvisible(stackTrace);
    stackTraceButton.value = "View Stack";
  } else {
    makeVisible(stackTrace);
    stackTraceButton.value = "Hide Stack";
  }
}
</script><style>* {
  font-family: Arial;
}
body {
  padding: 32px;  
}
pre {
  padding: 6px 28px 6px 28px;
  background-color: #E8EEF7;
}
pre, pre *, code, code *, kbd {
  font-family: Courier New, Courier;
  font-size: 10pt;
}
h1, h1 * {
  font-size: 24pt;	
}
p, td, th, li, .breadcrumbs {
  font-size: 10pt;
}
p, li {
  line-height: 140%;
  max-width: 720px;
}
table {
  border-collapse: collapse;
  empty-cells: show;
  margin: 8px 0px 8px 0px;
}
th, td {
  border: 1px solid black;
  padding: 3px;
}
td {
  background-color: white;
  vertical-align: top;
}
th {
  background-color: #C3D9FF;
}
li {
  margin-top: 6px;
  margin-bottom: 6px; 
}

.example, :not(th)[c\:example] {
  padding: 6px 16px 6px 16px;
  border: 1px solid #C3D9FF;
  margin: 6px 0px 28px 0px;
  background-color: #F5F9FD;
}
.example h3, [c\:example] h3 {
  margin-top: 8px;
  margin-bottom: 8px;
  font-size: 12pt;
}

p.success {
  padding: 2px;
}
.success, .success * {
  background-color: #afa !important;
}
.success pre {
  background-color: #bbffbb;
}
.failure, .failure * {
  background-color: #ffb0b0;
  padding: 1px;
}
.failure .expected {
  text-decoration: line-through;
  color: #bb5050;
}
.ignored, .ignored * {
  background-color: #f0f0f0 !important;	
}

ins {
  text-decoration: none;	
}

.exceptionMessage {
  background-color: #fdd;
  font-family: Courier New, Courier, Monospace;
  font-size: 10pt;
  display: block;
  font-weight: normal;
  padding: 4px;
  text-decoration: none !important;
}
.stackTrace, .stackTrace * {
  font-weight: normal;
}
.stackTrace {
  display: none;
  padding: 1px 4px 4px 4px;
  background-color: #fdd;
  border-top: 1px dotted black;
}
.stackTraceExceptionMessage {
  display: block;
  font-family: Courier New, Courier, Monospace;
  font-size: 8pt;
  white-space: wrap;
  padding: 1px 0px 1px 0px;
}
.stackTraceEntry {
  white-space: nowrap;
  font-family: Courier New, Courier, Monospace;
  display: block;
  font-size: 8pt;
  padding: 1px 0px 1px 32px;
}
.stackTraceButton {
  font-size: 8pt;
  margin: 2px 8px 2px 0px;
  font-weight: normal;
  font-family: Arial;
}

.special {
  font-style: italic;
}
.missing, .missing * {
  background-color: #ff9999;
  color:#bb5050;
  text-decoration: line-through;
}
.surplus, .surplus * {
  background-color: #ff9999;
}
.footer {
  text-align: right;
  margin-top: 40px;
  font-size: 8pt;
  width: 100%;
  color: #999;
}
.footer .testTime {
  padding: 2px 10px 0px 0px;
}

.idea {
  font-size: 9pt;
  color: #888;
  font-style: italic;	
}
.tight li {
  margin-top: 1px;
  margin-bottom: 1px; 
}
.commentary {
  float: right;
  width: 200px;
  background-color: #ffffd0;
  padding:8px;
  border: 3px solid #eeeeb0;	 
  margin: 10px 0px 10px 10px;	 
}
.commentary, .commentary * {
  font-size: 8pt;
}
</style><meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta charset="UTF-8" />
    <link href="../../../concordion.css" rel="stylesheet" type="text/css" />
    <title>Sofortüberweisung Charge w/o Separate Authorization</title>
<link type="text/css" rel="stylesheet" href="../../../inputstyle.css" /></head>
<body><span class="breadcrumbs"><a href="../../Specs.html">commercetools - PAYONE - Integration Service</a> &gt; <a href="../Paymentmethods.html">Payment Methods</a> &gt; <a href="Sofortueberweisung.html">Payments via Sofortueberweisung</a> &gt;</span>
<h1>Charge via Sofortüberweisung without separate Authorization</h1>
<p>
    The integration service allows to capture money from a bank account which supports transactions via <a href="https://www.sofort.com">Sofortüberweisung</a> in a
    one step process without initiating a separate authorization before.
</p>
<p>
    It will do so by sending an <em c:set="#requestType" class="inputvalue">authorization</em> request to the PAYONE platform.
    <br />
    It will store information about such a request as an interface interaction of type
    <em>PAYONE_INTERACTION_REQUEST</em>.
</p>
<p>
    Since Change 2.85 of Payone 2016-07-26:
</p>
    <blockquote>
    IBAN / BIC / bankcode / bankaccount can be omitted for SOFORTBanking (OBT/PNT) on API-level as they are returned from SOFORT and saved by PAYONE (for later upcoming SEPA-credits in case of refund).
    </blockquote>
<h3>Common Setup</h3>
<ul>
    <li>payment.paymentMethodInfo.method: <span c:set="#paymentMethod" class="inputvalue">BANK_TRANSFER-SOFORTUEBERWEISUNG</span></li>
    <li>payment.transactions[0].type: <span c:set="#transactionType" class="inputvalue">CHARGE</span></li>
</ul>
<div class="example">
    <h3>Charge immediately</h3>
    <p>
        Given the following payments for a bank account
        <em>that does support Sofortueberweisung</em> and <em>does <b>not</b> support charges for currencies other than EUR</em>:
    </p>
    <table c:execute="#paymentId = createPayment(#paymentName, #paymentMethod, #transactionType, #centAmount, #currencyCode, #iban, #bic)">
        <tr>
            <th c:set="#paymentName">Payment Name</th>
            <th c:set="#centAmount">Cent Amount</th>
            <th c:set="#currencyCode">Currency Code</th>
            <th c:set="#iban">IBAN</th>
            <th c:set="#bic">BIC</th>
            <th c:echo="#paymentId">Payment ID (for information only)</th>
        </tr>
        <tr>
            <td class="inputvalue">Payment 1</td>
            <td class="inputvalue">406</td>
            <td class="inputvalue">EUR</td>
            <td class="inputvalue">DE00123456782599100003</td>
            <td class="inputvalue">TESTTEST</td>
            <td>5499a44c-5bf0-4a85-a51e-0c30fedc5625</td>
        </tr>
        <tr>
            <td class="inputvalue">Payment 2</td>
            <td class="inputvalue">91341</td>
            <td class="inputvalue">USD</td>
            <td class="inputvalue" />
            <td class="inputvalue" />
            <td>859c98e7-9cb4-4df7-a74b-3b6ca69d0763</td>
        </tr>
        <tr>
            <td class="inputvalue">Payment 3</td>
            <td class="inputvalue">8231</td>
            <td class="inputvalue">EUR</td>
            <td class="inputvalue" />
            <td class="inputvalue" />
            <td>e642e4a2-7b9a-499c-a41b-98e05cc86771</td>
        </tr>
        <tr>
            <td class="inputvalue">Payment 4</td>
            <td class="inputvalue">123411</td>
            <td class="inputvalue">EUR</td>
            <td class="inputvalue" />
            <td class="inputvalue" />
            <td>46397083-e32e-4273-a972-de2c2f457f39</td>
        </tr>
    </table>
    <p>
        When I request the integration service to handle them I will get the following results:
    </p>
    <table c:execute="#result = handlePayment(#paymentName, #requestType)">
        <tr>
            <th c:set="#paymentName">Payment Name</th>
            <th c:assertEquals="#result.statusCode">Response <br />Status Code</th>
            <th c:assertEquals="#result.interactionCount">total # of <br /><em>authorization</em> requests sent</th>
            <th c:assertEquals="#result.transactionState">Transaction State </th>
            <th c:echo="#result.version">Version (for information only)</th>
        </tr>
        <tr>
            <td class="inputvalue">Payment 1</td>
            <td class="success">200</td>
            <td class="success">1</td>
            <td class="success">Pending</td>
            <td>11</td>
        </tr>
        <tr>
            <td class="inputvalue">Payment 2</td>
            <td class="success">200</td>
            <td class="success">1</td>
            <td class="success">Failure</td>
            <td>10</td>
        </tr>
        <tr>
            <td class="inputvalue">Payment 3</td>
            <td class="success">200</td>
            <td class="success">1</td>
            <td class="success">Pending</td>
            <td>11</td>
        </tr>
        <tr>
            <td class="inputvalue">Payment 4</td>
            <td class="success">200</td>
            <td class="success">1</td>
            <td class="success">Pending</td>
            <td>11</td>
        </tr>
    </table>
    <p>
        Since a valid payment for this bank account needs to be verified with Sofortueberweisung, the transaction will stay in state Pending
        as long as we don't follow the received redirect url and fill in the account information.
    </p>
    <table c:execute="#result = fetchPaymentDetails(#paymentName)">
        <tr>
            <th c:set="#paymentName">Payment Name</th>
            <th c:assertEquals="#result.transactionState">Transaction State </th>
            <th c:assertEquals="#result.responseRedirectUrlStart">redirect url starts with</th>
            <th c:echo="#result.version">Version (for information only)</th>
        </tr>
        <tr>
            <td class="inputvalue">Payment 1</td>
            <td class="success">Pending</td>
            <td class="success">https://www.sofort.com/payment/start</td>
            <td>11</td>
        </tr>
        <tr>
            <td class="inputvalue">Payment 3</td>
            <td class="success">Pending</td>
            <td class="success">https://www.sofort.com/payment/start</td>
            <td>11</td>
        </tr>
        <tr>
            <td class="inputvalue">Payment 4</td>
            <td class="success">Pending</td>
            <td class="success">https://www.sofort.com/payment/start</td>
            <td>11</td>
        </tr>
    </table>
    <p>
        The failed payment <span c:set="#failedPaymentName" class="inputvalue">Payment 2</span>
        must have received <span c:assertFalse="isInteractionRedirectPresent(#failedPaymentName)" class="success">0</span>
        responses of type PAYONE_INTERACTION_REDIRECT and its custom field <span c:set="#fieldName" class="inputvalue">redirectUrl</span>
        <span c:assertTrue="customStringFieldIsNull(#failedPaymentName, #fieldName)" class="success">must be null</span>.
    </p>
    <p>
        If I follow the Sofortueberweisung process for <span c:set="#successfulPayments" class="inputvalue">Payment 1, Payment 3, Payment 4</span> and
        <span c:assertTrue="executeRedirectForPayments(#successfulPayments)"><span class="failure"><del class="expected">verify them successfully</del></span><span class="exceptionMessage">org.openqa.selenium.SessionNotCreatedException: session not created: This version of ChromeDriver only supports Chrome version 79
Build info: version: '3.141.59', revision: 'e82be7d358', time: '2018-11-14T08:17:03'
System info: host: 'localhost', ip: '127.0.0.1', os.name: 'Linux', os.arch: 'amd64', os.version: '4.4.0-101-generic', java.version: '1.8.0_151'
Driver info: driver.version: CustomWebDriver
remote stacktrace: #0 0x55a229598479 &lt;unknown&gt;
</span><input class="stackTraceButton" id="stackTraceButton1" type="button" onclick="javascript:toggleStackTrace('1')" value="View Stack" /><div class="stackTrace" id="stackTrace1"><p>While evaluating expression: <code>executeRedirectForPayments(#successfulPayments)</code></p><div class="stackTraceExceptionMessage">org.concordion.internal.InvalidExpressionException: org.openqa.selenium.SessionNotCreatedException: session not created: This version of ChromeDriver only supports Chrome version 79
Build info: version: '3.141.59', revision: 'e82be7d358', time: '2018-11-14T08:17:03'
System info: host: 'localhost', ip: '127.0.0.1', os.name: 'Linux', os.arch: 'amd64', os.version: '4.4.0-101-generic', java.version: '1.8.0_151'
Driver info: driver.version: CustomWebDriver
remote stacktrace: #0 0x55a229598479 &lt;unknown&gt;
</div><div class="stackTraceEntry">at sun.reflect.NativeConstructorAccessorImpl.newInstance0 (NativeConstructorAccessorImpl.java:-2)</div><div class="stackTraceEntry">at sun.reflect.NativeConstructorAccessorImpl.newInstance (NativeConstructorAccessorImpl.java:62)</div><div class="stackTraceEntry">at sun.reflect.DelegatingConstructorAccessorImpl.newInstance (DelegatingConstructorAccessorImpl.java:45)</div><div class="stackTraceEntry">at java.lang.reflect.Constructor.newInstance (Constructor.java:423)</div><div class="stackTraceEntry">at org.openqa.selenium.remote.W3CHandshakeResponse.lambda$errorHandler$0 (W3CHandshakeResponse.java:62)</div><div class="stackTraceEntry">at org.openqa.selenium.remote.HandshakeResponse.lambda$getResponseFunction$0 (HandshakeResponse.java:30)</div><div class="stackTraceEntry">at org.openqa.selenium.remote.ProtocolHandshake.lambda$createSession$0 (ProtocolHandshake.java:126)</div><div class="stackTraceEntry">at java.util.stream.ReferencePipeline$3$1.accept (ReferencePipeline.java:193)</div><div class="stackTraceEntry">at java.util.Spliterators$ArraySpliterator.tryAdvance (Spliterators.java:958)</div><div class="stackTraceEntry">at java.util.stream.ReferencePipeline.forEachWithCancel (ReferencePipeline.java:126)</div><div class="stackTraceEntry">at java.util.stream.AbstractPipeline.copyIntoWithCancel (AbstractPipeline.java:498)</div><div class="stackTraceEntry">at java.util.stream.AbstractPipeline.copyInto (AbstractPipeline.java:485)</div><div class="stackTraceEntry">at java.util.stream.AbstractPipeline.wrapAndCopyInto (AbstractPipeline.java:471)</div><div class="stackTraceEntry">at java.util.stream.FindOps$FindOp.evaluateSequential (FindOps.java:152)</div><div class="stackTraceEntry">at java.util.stream.AbstractPipeline.evaluate (AbstractPipeline.java:234)</div><div class="stackTraceEntry">at java.util.stream.ReferencePipeline.findFirst (ReferencePipeline.java:464)</div><div class="stackTraceEntry">at org.openqa.selenium.remote.ProtocolHandshake.createSession (ProtocolHandshake.java:128)</div><div class="stackTraceEntry">at org.openqa.selenium.remote.ProtocolHandshake.createSession (ProtocolHandshake.java:74)</div><div class="stackTraceEntry">at org.openqa.selenium.remote.HttpCommandExecutor.execute (HttpCommandExecutor.java:136)</div><div class="stackTraceEntry">at org.openqa.selenium.remote.service.DriverCommandExecutor.execute (DriverCommandExecutor.java:83)</div><div class="stackTraceEntry">at org.openqa.selenium.remote.RemoteWebDriver.execute (RemoteWebDriver.java:552)</div><div class="stackTraceEntry">at org.openqa.selenium.remote.RemoteWebDriver.startSession (RemoteWebDriver.java:213)</div><div class="stackTraceEntry">at org.openqa.selenium.remote.RemoteWebDriver.&lt;init&gt; (RemoteWebDriver.java:131)</div><div class="stackTraceEntry">at org.openqa.selenium.chrome.ChromeDriver.&lt;init&gt; (ChromeDriver.java:181)</div><div class="stackTraceEntry">at org.openqa.selenium.chrome.ChromeDriver.&lt;init&gt; (ChromeDriver.java:168)</div><div class="stackTraceEntry">at org.openqa.selenium.chrome.ChromeDriver.&lt;init&gt; (ChromeDriver.java:157)</div><div class="stackTraceEntry">at util.CustomWebDriver.&lt;init&gt; (CustomWebDriver.java:20)</div><div class="stackTraceEntry">at util.WebDriverSofortueberweisung.&lt;init&gt; (WebDriverSofortueberweisung.java:23)</div><div class="stackTraceEntry">at specs.paymentmethods.sofortueberweisung.ChargeImmediatelyFixture.approvePaymentAsCustomer (ChargeImmediatelyFixture.java:174)</div><div class="stackTraceEntry">at java.util.stream.ReferencePipeline$3$1.accept (ReferencePipeline.java:193)</div><div class="stackTraceEntry">at java.util.Spliterators$ArraySpliterator.forEachRemaining (Spliterators.java:948)</div><div class="stackTraceEntry">at java.util.stream.AbstractPipeline.copyInto (AbstractPipeline.java:481)</div><div class="stackTraceEntry">at java.util.stream.AbstractPipeline.wrapAndCopyInto (AbstractPipeline.java:471)</div><div class="stackTraceEntry">at java.util.stream.ReduceOps$ReduceOp.evaluateSequential (ReduceOps.java:708)</div><div class="stackTraceEntry">at java.util.stream.AbstractPipeline.evaluate (AbstractPipeline.java:234)</div><div class="stackTraceEntry">at java.util.stream.ReferencePipeline.collect (ReferencePipeline.java:499)</div><div class="stackTraceEntry">at specs.paymentmethods.sofortueberweisung.ChargeImmediatelyFixture.executeRedirectForPayments (ChargeImmediatelyFixture.java:161)</div><div class="stackTraceEntry">at sun.reflect.NativeMethodAccessorImpl.invoke0 (NativeMethodAccessorImpl.java:-2)</div><div class="stackTraceEntry">at sun.reflect.NativeMethodAccessorImpl.invoke (NativeMethodAccessorImpl.java:62)</div><div class="stackTraceEntry">at sun.reflect.DelegatingMethodAccessorImpl.invoke (DelegatingMethodAccessorImpl.java:43)</div><div class="stackTraceEntry">at java.lang.reflect.Method.invoke (Method.java:498)</div><div class="stackTraceEntry">at ognl.OgnlRuntime.invokeMethod (OgnlRuntime.java:872)</div><div class="stackTraceEntry">at ognl.OgnlRuntime.callAppropriateMethod (OgnlRuntime.java:1295)</div><div class="stackTraceEntry">at ognl.ObjectMethodAccessor.callMethod (ObjectMethodAccessor.java:68)</div><div class="stackTraceEntry">at ognl.OgnlRuntime.callMethod (OgnlRuntime.java:1371)</div><div class="stackTraceEntry">at ognl.ASTMethod.getValueBody (ASTMethod.java:90)</div><div class="stackTraceEntry">at ognl.SimpleNode.evaluateGetValueBody (SimpleNode.java:212)</div><div class="stackTraceEntry">at ognl.SimpleNode.getValue (SimpleNode.java:258)</div><div class="stackTraceEntry">at ognl.Ognl.getValue (Ognl.java:494)</div><div class="stackTraceEntry">at ognl.Ognl.getValue (Ognl.java:596)</div><div class="stackTraceEntry">at ognl.Ognl.getValue (Ognl.java:566)</div><div class="stackTraceEntry">at org.concordion.internal.OgnlEvaluator.evaluate (OgnlEvaluator.java:25)</div><div class="stackTraceEntry">at org.concordion.internal.SimpleEvaluator.evaluate (SimpleEvaluator.java:14)</div><div class="stackTraceEntry">at org.concordion.internal.command.BooleanCommand.verify (BooleanCommand.java:33)</div><div class="stackTraceEntry">at org.concordion.api.AbstractCommandDecorator$3.run (AbstractCommandDecorator.java:33)</div><div class="stackTraceEntry">at org.concordion.internal.command.LocalTextDecorator.process (LocalTextDecorator.java:26)</div><div class="stackTraceEntry">at org.concordion.api.AbstractCommandDecorator.verify (AbstractCommandDecorator.java:31)</div><div class="stackTraceEntry">at org.concordion.api.AbstractCommandDecorator$3.run (AbstractCommandDecorator.java:33)</div><div class="stackTraceEntry">at org.concordion.internal.command.ThrowableCatchingDecorator.process (ThrowableCatchingDecorator.java:38)</div><div class="stackTraceEntry">at org.concordion.api.AbstractCommandDecorator.verify (AbstractCommandDecorator.java:31)</div><div class="stackTraceEntry">at org.concordion.api.CommandCall.verify (CommandCall.java:76)</div><div class="stackTraceEntry">at org.concordion.api.CommandCallList.processSequentially (CommandCallList.java:34)</div><div class="stackTraceEntry">at org.concordion.internal.command.SpecificationCommand.execute (SpecificationCommand.java:36)</div><div class="stackTraceEntry">at org.concordion.api.CommandCall.execute (CommandCall.java:72)</div><div class="stackTraceEntry">at org.concordion.internal.XMLSpecification.processNode (XMLSpecification.java:60)</div><div class="stackTraceEntry">at org.concordion.internal.XMLSpecification.processExample (XMLSpecification.java:69)</div><div class="stackTraceEntry">at org.concordion.Concordion.processExample (Concordion.java:92)</div><div class="stackTraceEntry">at org.concordion.internal.FixtureRunner.run (FixtureRunner.java:41)</div><div class="stackTraceEntry">at org.concordion.integration.junit4.ConcordionRunner.invoke (ConcordionRunner.java:207)</div><div class="stackTraceEntry">at org.concordion.integration.junit4.ConcordionRunner$1.invoke (ConcordionRunner.java:31)</div><div class="stackTraceEntry">at org.concordion.integration.junit4.ConcordionFrameworkMethod.invokeExplosively (ConcordionFrameworkMethod.java:58)</div><div class="stackTraceEntry">at org.junit.internal.runners.statements.InvokeMethod.evaluate (InvokeMethod.java:17)</div><div class="stackTraceEntry">at org.junit.internal.runners.statements.RunBefores.evaluate (RunBefores.java:26)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner.runLeaf (ParentRunner.java:325)</div><div class="stackTraceEntry">at org.junit.runners.BlockJUnit4ClassRunner.runChild (BlockJUnit4ClassRunner.java:78)</div><div class="stackTraceEntry">at org.concordion.integration.junit4.ConcordionRunner.runChild (ConcordionRunner.java:191)</div><div class="stackTraceEntry">at org.concordion.integration.junit4.ConcordionRunner.runChild (ConcordionRunner.java:23)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner$3.run (ParentRunner.java:290)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner$1.schedule (ParentRunner.java:71)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner.runChildren (ParentRunner.java:288)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner.access$000 (ParentRunner.java:58)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner$2.evaluate (ParentRunner.java:268)</div><div class="stackTraceEntry">at org.junit.internal.runners.statements.RunBefores.evaluate (RunBefores.java:26)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner.run (ParentRunner.java:363)</div><div class="stackTraceEntry">at org.concordion.integration.junit4.ConcordionRunner.run (ConcordionRunner.java:150)</div><div class="stackTraceEntry">at org.junit.runners.Suite.runChild (Suite.java:128)</div><div class="stackTraceEntry">at org.junit.runners.Suite.runChild (Suite.java:27)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner$3.run (ParentRunner.java:290)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner$1.schedule (ParentRunner.java:71)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner.runChildren (ParentRunner.java:288)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner.access$000 (ParentRunner.java:58)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner$2.evaluate (ParentRunner.java:268)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner.run (ParentRunner.java:363)</div><div class="stackTraceEntry">at org.junit.runner.JUnitCore.run (JUnitCore.java:137)</div><div class="stackTraceEntry">at org.junit.runner.JUnitCore.run (JUnitCore.java:115)</div><div class="stackTraceEntry">at org.junit.runner.JUnitCore.run (JUnitCore.java:105)</div><div class="stackTraceEntry">at org.junit.runner.JUnitCore.runClasses (JUnitCore.java:62)</div><div class="stackTraceEntry">at org.junit.runner.JUnitCore.runClasses (JUnitCore.java:49)</div><div class="stackTraceEntry">at org.concordion.internal.runner.DefaultConcordionRunner.runJUnitClass (DefaultConcordionRunner.java:78)</div><div class="stackTraceEntry">at org.concordion.internal.runner.DefaultConcordionRunner.runTestClass (DefaultConcordionRunner.java:44)</div><div class="stackTraceEntry">at org.concordion.internal.runner.DefaultConcordionRunner.execute (DefaultConcordionRunner.java:19)</div><div class="stackTraceEntry">at org.concordion.ext.run.parallel.ParallelRunStrategy$1.call (ParallelRunStrategy.java:141)</div><div class="stackTraceEntry">at org.concordion.ext.run.parallel.ParallelRunStrategy$1.call (ParallelRunStrategy.java:136)</div><div class="stackTraceEntry">at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly (TrustedListenableFutureTask.java:125)</div><div class="stackTraceEntry">at com.google.common.util.concurrent.InterruptibleTask.run (InterruptibleTask.java:57)</div><div class="stackTraceEntry">at com.google.common.util.concurrent.TrustedListenableFutureTask.run (TrustedListenableFutureTask.java:78)</div><div class="stackTraceEntry">at java.util.concurrent.ThreadPoolExecutor.runWorker (ThreadPoolExecutor.java:1149)</div><div class="stackTraceEntry">at java.util.concurrent.ThreadPoolExecutor$Worker.run (ThreadPoolExecutor.java:624)</div><div class="stackTraceEntry">at java.lang.Thread.run (Thread.java:748)</div><div class="stackTraceExceptionMessage">org.openqa.selenium.SessionNotCreatedException: session not created: This version of ChromeDriver only supports Chrome version 79
Build info: version: '3.141.59', revision: 'e82be7d358', time: '2018-11-14T08:17:03'
System info: host: 'localhost', ip: '127.0.0.1', os.name: 'Linux', os.arch: 'amd64', os.version: '4.4.0-101-generic', java.version: '1.8.0_151'
Driver info: driver.version: CustomWebDriver
remote stacktrace: #0 0x55a229598479 &lt;unknown&gt;
</div><div class="stackTraceEntry">at sun.reflect.NativeConstructorAccessorImpl.newInstance0 (NativeConstructorAccessorImpl.java:-2)</div><div class="stackTraceEntry">at sun.reflect.NativeConstructorAccessorImpl.newInstance (NativeConstructorAccessorImpl.java:62)</div><div class="stackTraceEntry">at sun.reflect.DelegatingConstructorAccessorImpl.newInstance (DelegatingConstructorAccessorImpl.java:45)</div><div class="stackTraceEntry">at java.lang.reflect.Constructor.newInstance (Constructor.java:423)</div><div class="stackTraceEntry">at org.openqa.selenium.remote.W3CHandshakeResponse.lambda$errorHandler$0 (W3CHandshakeResponse.java:62)</div><div class="stackTraceEntry">at org.openqa.selenium.remote.HandshakeResponse.lambda$getResponseFunction$0 (HandshakeResponse.java:30)</div><div class="stackTraceEntry">at org.openqa.selenium.remote.ProtocolHandshake.lambda$createSession$0 (ProtocolHandshake.java:126)</div><div class="stackTraceEntry">at java.util.stream.ReferencePipeline$3$1.accept (ReferencePipeline.java:193)</div><div class="stackTraceEntry">at java.util.Spliterators$ArraySpliterator.tryAdvance (Spliterators.java:958)</div><div class="stackTraceEntry">at java.util.stream.ReferencePipeline.forEachWithCancel (ReferencePipeline.java:126)</div><div class="stackTraceEntry">at java.util.stream.AbstractPipeline.copyIntoWithCancel (AbstractPipeline.java:498)</div><div class="stackTraceEntry">at java.util.stream.AbstractPipeline.copyInto (AbstractPipeline.java:485)</div><div class="stackTraceEntry">at java.util.stream.AbstractPipeline.wrapAndCopyInto (AbstractPipeline.java:471)</div><div class="stackTraceEntry">at java.util.stream.FindOps$FindOp.evaluateSequential (FindOps.java:152)</div><div class="stackTraceEntry">at java.util.stream.AbstractPipeline.evaluate (AbstractPipeline.java:234)</div><div class="stackTraceEntry">at java.util.stream.ReferencePipeline.findFirst (ReferencePipeline.java:464)</div><div class="stackTraceEntry">at org.openqa.selenium.remote.ProtocolHandshake.createSession (ProtocolHandshake.java:128)</div><div class="stackTraceEntry">at org.openqa.selenium.remote.ProtocolHandshake.createSession (ProtocolHandshake.java:74)</div><div class="stackTraceEntry">at org.openqa.selenium.remote.HttpCommandExecutor.execute (HttpCommandExecutor.java:136)</div><div class="stackTraceEntry">at org.openqa.selenium.remote.service.DriverCommandExecutor.execute (DriverCommandExecutor.java:83)</div><div class="stackTraceEntry">at org.openqa.selenium.remote.RemoteWebDriver.execute (RemoteWebDriver.java:552)</div><div class="stackTraceEntry">at org.openqa.selenium.remote.RemoteWebDriver.startSession (RemoteWebDriver.java:213)</div><div class="stackTraceEntry">at org.openqa.selenium.remote.RemoteWebDriver.&lt;init&gt; (RemoteWebDriver.java:131)</div><div class="stackTraceEntry">at org.openqa.selenium.chrome.ChromeDriver.&lt;init&gt; (ChromeDriver.java:181)</div><div class="stackTraceEntry">at org.openqa.selenium.chrome.ChromeDriver.&lt;init&gt; (ChromeDriver.java:168)</div><div class="stackTraceEntry">at org.openqa.selenium.chrome.ChromeDriver.&lt;init&gt; (ChromeDriver.java:157)</div><div class="stackTraceEntry">at util.CustomWebDriver.&lt;init&gt; (CustomWebDriver.java:20)</div><div class="stackTraceEntry">at util.WebDriverSofortueberweisung.&lt;init&gt; (WebDriverSofortueberweisung.java:23)</div><div class="stackTraceEntry">at specs.paymentmethods.sofortueberweisung.ChargeImmediatelyFixture.approvePaymentAsCustomer (ChargeImmediatelyFixture.java:174)</div><div class="stackTraceEntry">at java.util.stream.ReferencePipeline$3$1.accept (ReferencePipeline.java:193)</div><div class="stackTraceEntry">at java.util.Spliterators$ArraySpliterator.forEachRemaining (Spliterators.java:948)</div><div class="stackTraceEntry">at java.util.stream.AbstractPipeline.copyInto (AbstractPipeline.java:481)</div><div class="stackTraceEntry">at java.util.stream.AbstractPipeline.wrapAndCopyInto (AbstractPipeline.java:471)</div><div class="stackTraceEntry">at java.util.stream.ReduceOps$ReduceOp.evaluateSequential (ReduceOps.java:708)</div><div class="stackTraceEntry">at java.util.stream.AbstractPipeline.evaluate (AbstractPipeline.java:234)</div><div class="stackTraceEntry">at java.util.stream.ReferencePipeline.collect (ReferencePipeline.java:499)</div><div class="stackTraceEntry">at specs.paymentmethods.sofortueberweisung.ChargeImmediatelyFixture.executeRedirectForPayments (ChargeImmediatelyFixture.java:161)</div><div class="stackTraceEntry">at sun.reflect.NativeMethodAccessorImpl.invoke0 (NativeMethodAccessorImpl.java:-2)</div><div class="stackTraceEntry">at sun.reflect.NativeMethodAccessorImpl.invoke (NativeMethodAccessorImpl.java:62)</div><div class="stackTraceEntry">at sun.reflect.DelegatingMethodAccessorImpl.invoke (DelegatingMethodAccessorImpl.java:43)</div><div class="stackTraceEntry">at java.lang.reflect.Method.invoke (Method.java:498)</div><div class="stackTraceEntry">at ognl.OgnlRuntime.invokeMethod (OgnlRuntime.java:872)</div><div class="stackTraceEntry">at ognl.OgnlRuntime.callAppropriateMethod (OgnlRuntime.java:1295)</div><div class="stackTraceEntry">at ognl.ObjectMethodAccessor.callMethod (ObjectMethodAccessor.java:68)</div><div class="stackTraceEntry">at ognl.OgnlRuntime.callMethod (OgnlRuntime.java:1371)</div><div class="stackTraceEntry">at ognl.ASTMethod.getValueBody (ASTMethod.java:90)</div><div class="stackTraceEntry">at ognl.SimpleNode.evaluateGetValueBody (SimpleNode.java:212)</div><div class="stackTraceEntry">at ognl.SimpleNode.getValue (SimpleNode.java:258)</div><div class="stackTraceEntry">at ognl.Ognl.getValue (Ognl.java:494)</div><div class="stackTraceEntry">at ognl.Ognl.getValue (Ognl.java:596)</div><div class="stackTraceEntry">at ognl.Ognl.getValue (Ognl.java:566)</div><div class="stackTraceEntry">at org.concordion.internal.OgnlEvaluator.evaluate (OgnlEvaluator.java:25)</div><div class="stackTraceEntry">at org.concordion.internal.SimpleEvaluator.evaluate (SimpleEvaluator.java:14)</div><div class="stackTraceEntry">at org.concordion.internal.command.BooleanCommand.verify (BooleanCommand.java:33)</div><div class="stackTraceEntry">at org.concordion.api.AbstractCommandDecorator$3.run (AbstractCommandDecorator.java:33)</div><div class="stackTraceEntry">at org.concordion.internal.command.LocalTextDecorator.process (LocalTextDecorator.java:26)</div><div class="stackTraceEntry">at org.concordion.api.AbstractCommandDecorator.verify (AbstractCommandDecorator.java:31)</div><div class="stackTraceEntry">at org.concordion.api.AbstractCommandDecorator$3.run (AbstractCommandDecorator.java:33)</div><div class="stackTraceEntry">at org.concordion.internal.command.ThrowableCatchingDecorator.process (ThrowableCatchingDecorator.java:38)</div><div class="stackTraceEntry">at org.concordion.api.AbstractCommandDecorator.verify (AbstractCommandDecorator.java:31)</div><div class="stackTraceEntry">at org.concordion.api.CommandCall.verify (CommandCall.java:76)</div><div class="stackTraceEntry">at org.concordion.api.CommandCallList.processSequentially (CommandCallList.java:34)</div><div class="stackTraceEntry">at org.concordion.internal.command.SpecificationCommand.execute (SpecificationCommand.java:36)</div><div class="stackTraceEntry">at org.concordion.api.CommandCall.execute (CommandCall.java:72)</div><div class="stackTraceEntry">at org.concordion.internal.XMLSpecification.processNode (XMLSpecification.java:60)</div><div class="stackTraceEntry">at org.concordion.internal.XMLSpecification.processExample (XMLSpecification.java:69)</div><div class="stackTraceEntry">at org.concordion.Concordion.processExample (Concordion.java:92)</div><div class="stackTraceEntry">at org.concordion.internal.FixtureRunner.run (FixtureRunner.java:41)</div><div class="stackTraceEntry">at org.concordion.integration.junit4.ConcordionRunner.invoke (ConcordionRunner.java:207)</div><div class="stackTraceEntry">at org.concordion.integration.junit4.ConcordionRunner$1.invoke (ConcordionRunner.java:31)</div><div class="stackTraceEntry">at org.concordion.integration.junit4.ConcordionFrameworkMethod.invokeExplosively (ConcordionFrameworkMethod.java:58)</div><div class="stackTraceEntry">at org.junit.internal.runners.statements.InvokeMethod.evaluate (InvokeMethod.java:17)</div><div class="stackTraceEntry">at org.junit.internal.runners.statements.RunBefores.evaluate (RunBefores.java:26)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner.runLeaf (ParentRunner.java:325)</div><div class="stackTraceEntry">at org.junit.runners.BlockJUnit4ClassRunner.runChild (BlockJUnit4ClassRunner.java:78)</div><div class="stackTraceEntry">at org.concordion.integration.junit4.ConcordionRunner.runChild (ConcordionRunner.java:191)</div><div class="stackTraceEntry">at org.concordion.integration.junit4.ConcordionRunner.runChild (ConcordionRunner.java:23)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner$3.run (ParentRunner.java:290)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner$1.schedule (ParentRunner.java:71)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner.runChildren (ParentRunner.java:288)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner.access$000 (ParentRunner.java:58)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner$2.evaluate (ParentRunner.java:268)</div><div class="stackTraceEntry">at org.junit.internal.runners.statements.RunBefores.evaluate (RunBefores.java:26)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner.run (ParentRunner.java:363)</div><div class="stackTraceEntry">at org.concordion.integration.junit4.ConcordionRunner.run (ConcordionRunner.java:150)</div><div class="stackTraceEntry">at org.junit.runners.Suite.runChild (Suite.java:128)</div><div class="stackTraceEntry">at org.junit.runners.Suite.runChild (Suite.java:27)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner$3.run (ParentRunner.java:290)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner$1.schedule (ParentRunner.java:71)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner.runChildren (ParentRunner.java:288)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner.access$000 (ParentRunner.java:58)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner$2.evaluate (ParentRunner.java:268)</div><div class="stackTraceEntry">at org.junit.runners.ParentRunner.run (ParentRunner.java:363)</div><div class="stackTraceEntry">at org.junit.runner.JUnitCore.run (JUnitCore.java:137)</div><div class="stackTraceEntry">at org.junit.runner.JUnitCore.run (JUnitCore.java:115)</div><div class="stackTraceEntry">at org.junit.runner.JUnitCore.run (JUnitCore.java:105)</div><div class="stackTraceEntry">at org.junit.runner.JUnitCore.runClasses (JUnitCore.java:62)</div><div class="stackTraceEntry">at org.junit.runner.JUnitCore.runClasses (JUnitCore.java:49)</div><div class="stackTraceEntry">at org.concordion.internal.runner.DefaultConcordionRunner.runJUnitClass (DefaultConcordionRunner.java:78)</div><div class="stackTraceEntry">at org.concordion.internal.runner.DefaultConcordionRunner.runTestClass (DefaultConcordionRunner.java:44)</div><div class="stackTraceEntry">at org.concordion.internal.runner.DefaultConcordionRunner.execute (DefaultConcordionRunner.java:19)</div><div class="stackTraceEntry">at org.concordion.ext.run.parallel.ParallelRunStrategy$1.call (ParallelRunStrategy.java:141)</div><div class="stackTraceEntry">at org.concordion.ext.run.parallel.ParallelRunStrategy$1.call (ParallelRunStrategy.java:136)</div><div class="stackTraceEntry">at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly (TrustedListenableFutureTask.java:125)</div><div class="stackTraceEntry">at com.google.common.util.concurrent.InterruptibleTask.run (InterruptibleTask.java:57)</div><div class="stackTraceEntry">at com.google.common.util.concurrent.TrustedListenableFutureTask.run (TrustedListenableFutureTask.java:78)</div><div class="stackTraceEntry">at java.util.concurrent.ThreadPoolExecutor.runWorker (ThreadPoolExecutor.java:1149)</div><div class="stackTraceEntry">at java.util.concurrent.ThreadPoolExecutor$Worker.run (ThreadPoolExecutor.java:624)</div><div class="stackTraceEntry">at java.lang.Thread.run (Thread.java:748)</div></div></span> by entering my bank account information,
        I get forwarded to a predefined success url and for each of the payments the following notifications will be received:
    </p>
    <ol>
        <li>(txaction=<b c:set="#txactionAppointed" class="inputvalue">appointed</b>, transactionstatus=<b>completed</b>) <span c:assertTrue="receivedNotificationOfActionFor(#successfulPayments, #txactionAppointed)" class="failure"><del class="expected">received</del>
<ins class="actual">== false</ins></span> -&gt; has no effect, just as a confirmation</li>
        <li>(txaction=<b c:set="#txactionPaid" class="inputvalue">paid</b>, transactionstatus=<b>completed</b> or <b>null</b>) <span c:assertTrue="receivedNextNotificationOfActionFor(#successfulPayments, #txactionPaid, #txactionAppointed)" class="failure"><del class="expected">received</del>
<ins class="actual">== false</ins></span>
            -&gt;  The state of the Charge transaction, the authorized amount and the paid amount should be set correctly not later than now.</li>
    </ol>
    <table c:execute="#result = fetchPaymentDetails(#paymentName)">
        <tr>
            <th c:set="#paymentName">Payment Name</th>
            <th c:assertEquals="#result.transactionState">Transaction State</th>
            <th c:assertEquals="#result.appointedNotificationCount">total # of <br /><em>appointed/completed</em> notifications</th>
            <th c:assertEquals="#result.paidNotificationCount">total # of <br /><em>paid/completed</em> notifications</th>
            <th c:assertEquals="#result.successUrl">url called after successful verification</th>
            <th c:echo="#result.version">Version (for information only)</th>
        </tr>
        <tr>
            <td class="inputvalue">Payment 1</td>
            <td class="failure"><del class="expected">Success</del>
<ins class="actual">Pending</ins></td>
            <td class="failure"><del class="expected">1</del>
<ins class="actual">0</ins></td>
            <td class="failure"><del class="expected">1</del>
<ins class="actual">0</ins></td>
            <td class="failure"><del class="expected">[...]Payment-1-Success</del>
<ins class="actual"> </ins></td>
            <td>11</td>
        </tr>
        <tr>
            <td class="inputvalue">Payment 3</td>
            <td class="failure"><del class="expected">Success</del>
<ins class="actual">Pending</ins></td>
            <td class="failure"><del class="expected">1</del>
<ins class="actual">0</ins></td>
            <td class="failure"><del class="expected">1</del>
<ins class="actual">0</ins></td>
            <td class="failure"><del class="expected">[...]Payment-3-Success</del>
<ins class="actual"> </ins></td>
            <td>11</td>
        </tr>
        <tr>
            <td class="inputvalue">Payment 4</td>
            <td class="failure"><del class="expected">Success</del>
<ins class="actual">Pending</ins></td>
            <td class="failure"><del class="expected">1</del>
<ins class="actual">0</ins></td>
            <td class="failure"><del class="expected">1</del>
<ins class="actual">0</ins></td>
            <td class="failure"><del class="expected">[...]Payment-4-Success</del>
<ins class="actual"> </ins></td>
            <td>11</td>
        </tr>
        <p>
            See <a href="https://github.com/commercetools/commercetools-payone-integration/issues/68">issue #68</a>.
        </p>
    </table>

    <h3>Verify Order#paymentState</h3>
    <p>For <b>paid</b> payments it expected to be <b>Paid</b>,
        for failed <i>Payment 2</i> - unchanged (null)</p>
    <table c:execute="#orderPaymentState = fetchOrderPaymentState(#paymentName)">
        <tr>
            <th c:set="#paymentName">Payment Name</th>
            <th c:assertEquals="#orderPaymentState">Order Payment State</th>
        </tr>
        <tr>
            <td class="inputvalue">Payment 1</td>
            <td class="failure"><del class="expected">Paid</del>
<ins class="actual">(null)</ins></td>
        </tr>
        <tr>
            <td class="inputvalue">Payment 2</td>
            <td class="success">(null)</td>
        </tr>
        <tr>
            <td class="inputvalue">Payment 3</td>
            <td class="failure"><del class="expected">Paid</del>
<ins class="actual">(null)</ins></td>
        </tr>
        <tr>
            <td class="inputvalue">Payment 4</td>
            <td class="failure"><del class="expected">Paid</del>
<ins class="actual">(null)</ins></td>
        </tr>
    </table>

</div>
<h2>Further Details</h2>
<h3>What happens if the verification fails?</h3>

<ol>
    <li><a href="/commercetools-payone-integration/latest/tests/testSpec/classes/specs.SpecsFixture.html">Check the test logs</a>
        (click <i><b>Standard output</b></i> tab there)</li>
    <li>Check the name of the input fields in <code>WebDriverSofortueberweisung/WebDriverSofortueberweisungConstants</code>.
        If the Sofortüberweisung site changes the elements names - the test should be updated.</li>
    <li>Check potential issues during the payments creation. The payments won't be notified about status change once
        they are failed!</li>
    <li>The checkout implementation needs to take care of failed verifications - the user will be redirected to
        the <em>backUrl</em> or the <em>errorUrl</em> specified in the Payment object</li>
</ol>
<div class="footer">Results generated by <a href="http://www.concordion.org" style="font-weight: bold; text-decoration: none; color: #89C;">Concordion</a><div class="testTime">in 58899 ms on 11-Aug-2020 at 10:14:22 UTC</div></div></body>
</html>